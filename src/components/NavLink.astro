---
import type { HTMLAttributes } from 'astro/types';

type Props = HTMLAttributes<'a'>;

const { href, class: className, ...props } = Astro.props;

const { pathname } = Astro.url;
const base = import.meta.env.BASE_URL.replace(/\/$/, '');
const normalizedHref = href?.toString().startsWith('/') && !href?.toString().startsWith(base) 
    ? `${base}${href}` 
    : href;

const isActive = normalizedHref === pathname || normalizedHref === pathname.replace(/\/$/, '');
---

<a class:list={[className, { 'underline decoration-1 underline-offset-2': isActive }]} href={normalizedHref} {...props}>
    <slot />
</a>
